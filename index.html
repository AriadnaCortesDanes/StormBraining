<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,600|Open+Sans" rel="stylesheet"> 
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
	<link rel="stylesheet" href="estilos.css">
    <title>BanBanDis</title>
</head>
<body>
	<div id= "container" class="contenedor">
		<img id="logo" src="logo.png">
        <img id="brain" src="StormBraining_logo.jpg" width="100" heigth="100">
        <button id="btn-abrir-popup" class="btn-abrir-popup">
            <span class = "button__text"> How to play? </span>
            <span class = "button__icon">
                <ion-icon name="help-circle-outline"></ion-icon>
            </span> 
    
        </button>
		
	</div>

    <!-- codi de logica del joc-->
    <button id= "Recarga" class="options">
        <img id="recarga" src="https://icons-for-free.com/download-icon-refresh+reload+update+icon-1320191166843452904_256.png"
        width = "120" height = "120">
    </button>
    <button id= "Escut" class="options"><img id="escut" src="https://images.emojiterra.com/google/android-11/512px/1f6e1.png"
        width = "120" height = "120">
    </button>
    <button id= "Dispara" class="options"><img id="dispara" src="https://images.vexels.com/media/users/3/158137/isolated/preview/9c38dddc84fdc68a27ca10230595f183-icono-detallado-de-revolver.png"
        width = "120" height = "120">
    </button>
    <button id= "Vidas" class="options"><img id="vidas" src="https://www.heypoorplayer.com/wp-content/uploads/2014/06/heart-e1403272720870.png"
        width = "120" height = "120">
    </button>
    
    </button>
    <button id="BotResponse" class="buttonResult">
        <img id="botresponse" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Question_mark_%28black%29.svg/480px-Question_mark_%28black%29.svg.png"
        width = "120" height = "120">
        <span class = "button__text2"> BOT </span>
    </button>


        <h2>
            MyName:
        </h2>
        <p id="afegir_precarga">
                Recarga:
        </p>   
        <p id="afegir_pvidas">
                Vidas: 
        </p>
        <h2>
            Computer:
        </h2>
        <p id="afegir_crecarga">
            Recarga:
        </p>
        <p id="afegir_cvidas">
                Vidas: 
        </p>
        <p id="quefacomputer"></p>

    <!--<button id="Start" class="btn-start">
            <span class = "button__text"> START! </span>
            <span class = "button__icon">
                <ion-icon name="checkmark-circle-outline"></ion-icon>
            </span> 
        </button>
    -->
        <div class="overlay" id="overlay">
			<div class="popup" id="popup">
				<a href="#" id="btn-cerrar-popup" class="btn-cerrar-popup"><i class="fas fa-times"></i></a>
				<h3>DAN DAN DISH</h3>
				<h4>How to play?</h4>
				<form action="">
					<div class="contenedor-inputs">
                        <p>
                            We present you our game Dan Dan Dish! It is a very simple game and it is really fun to play.
You will play with a bot and your objective is to kill the bot before it kills you.
In each round you will have to click one of these four icons.
<br \> <br \>
If you click the recharge icon you will have one more bullet to shoot in another round.
If you click the gun, you will shoot the bot and it will have one life less. If you have no charges, gun has no effect. 
If you click the shield and the bot shoots you in the same round, the bullet wonâ€™t take you any life
If you click the heart you will have one more life.
Whoever runs out of lives first, loses.
                        </p>
					</div>
                    <button id="btn-start" class="btn-start">
                        <span class = "button__text"> START! </span>
                        <span class = "button__icon">
                            <ion-icon name="checkmark-circle-outline"></ion-icon>
                        </span> 
               
                    </button>
				</form>
			</div>
		</div>

        <div class="overlay" id="winOverlay">
			<div class="popup" id="winPopup">
				<h3>YOU'RE THE WINNER</h3>
				<h4>Congratulations!</h4>
				<form action="">
					<div class="contenedor-inputs">
                        <p>
                           You can play again with the Start! button.
                        </p>
					</div>
                    <button id="start-win" class="btn-start">
                        <span class = "button__text"> START! </span>
                        <span class = "button__icon">
                            <ion-icon name="checkmark-circle-outline"></ion-icon>
                        </span> 
               
                    </button>
				</form>
			</div>
		</div>

        <div class="overlay" id="loseOverlay">
			<div class="popup" id="losePopup">
				<h3>YOU'VE LOST :(</h3>
				<h4>Try again!</h4>
				<form action="">
					<div class="contenedor-inputs">
                        <p>
                           You can play again with the Start! button.
                        </p>
					</div>
                    <button id="start-lose" class="btn-start">
                        <span class = "button__text"> START! </span>
                        <span class = "button__icon">
                            <ion-icon name="checkmark-circle-outline"></ion-icon>
                        </span> 
               
                    </button>
				</form>
			</div>
		</div>

        
        <script>
            const options = document.querySelectorAll(".options");

            let pRecarga = 0;
            let cRecarga = 0;
            let pVidas = 1;
            let cVidas = 1;
            let numRondes = 0;

            document.getElementById("afegir_precarga").innerHTML += pRecarga;
            document.getElementById("afegir_crecarga").innerHTML += cRecarga;
            document.getElementById("afegir_pvidas").innerHTML += pVidas;
            document.getElementById("afegir_cvidas").innerHTML += cVidas;

            options.forEach((option) => {
              option.addEventListener("click", function () {
                const pInput = this.id;
                
                const cOptions = ["recarga", "escut", "dispara", "vidas"];
                const cInput = cOptions[Math.floor(Math.random() * 4)];

                document.getElementById("quefacomputer").innerHTML = pInput;
                document.getElementById("quefacomputer").innerHTML += cInput;

                setTimeout(function(){
                    document.getElementById("botresponse").src = document.getElementById(cInput).src;
                    compareInputs(pInput, cInput);
                    updateValors();},500);
              });
            });

            function compareInputs(pInput, cInput) {
                const currentMatch = `${pInput} vs ${cInput}`;
                // if (pInput === cInput) {
                   // alert(`${currentMatch} is a Tie`);
                    //return;
                //}

                // si el computer intenta dispara i no te recargas, fa una recarga
                if (cInput === "dispara" && cRecarga == 0) {
                    cInput = "recarga";
                }

                // si el jugador decideix recarregar
                if (pInput === "Recarga") {
                    pRecarga++;
                    if (cInput === "recarga") {
                        cRecarga++;
                    }
                    else if (cInput === "dispara") {
                        --cRecarga;
                        muerte("p");
                    }
                    else if (cInput === "vidas") {
                        ++cVidas;
                        updateVidas();
                    }
                    else if (cInput === "escut") {} // no passa res
                }

                // si el jugador decideix disparar
                if (pInput === "Dispara") {
                    // if (pRecarga === 0) {}
                    if (cInput === "vidas" && pRecarga > 0) {
                        --pRecarga;
                    }
                    else if (cInput === "vidas" && pRecarga === 0) {
                        ++cVidas;
                        updateVidas();
                    }
                    else if (cInput === "escut" && pRecarga > 0) {
                        --pRecarga;
                    }
                    else if (cInput === "escut" && pRecarga === 0) {}
                    else if (cInput === "recarga") {
                        cRecarga++;
                        if (pRecarga > 0)  {
                            --pRecarga;
                            muerte("c");
                        }
                    }
                    else if (cInput === "dispara") {
                        --cRecarga;
                        if (pRecarga > 0) {
                            --pRecarga;
                            muertedos(); // quan es disparen els dos alhora
                        }
                        else {
                            muerte("p");
                        }
                    }
                }

                // si el jugador decideix posar escut
                if (pInput === "Escut") {
                    if (cInput === "recarga") {
                        ++cRecarga;
                    }
                    else if (cInput === "dispara") {
                        --cRecarga;
                    }
                    else if (cInput === "escut") {}
                    else if (cInput === "vidas") {
                        ++cVidas;
                        updateVidas();
                    }
                }

                if (pInput === "Vidas") {
                    ++pVidas;
                    updateVidas();
                    if (cInput === "recarga") {
                        ++cRecarga;
                    }
                    else if (cInput === "dispara") {
                        --cRecarga;
                    }
                    else if (cInput === "escut") {}
                    else if (cInput === "vidas") {
                        ++cVidas;
                    }
                }

                //if (cInput === "Recarga") {
                    //  cRecarga++;
                //}              
            }

            // actualitza el valor de les recargues
            function updateValors() {
                document.getElementById("afegir_precarga").textContent = "Recarga: "+ pRecarga;
                document.getElementById("afegir_crecarga").textContent = "Recarga: "+ cRecarga;
            }

            // quan algu perd una vida
            function muerte(who) {
                if (who === "p") {
                    --pVidas;
                    updateVidas();
                    if (pVidas === 0) {
                        // RESULTAT: GUANYA COMPUTER
                        fin(0);
                    }
                }
                else if (who === "c") {
                    --cVidas;
                    updateVidas();
                    if (cVidas === 0) {
                        // RESULTAT: GUANYA PLAYER
                        fin(1);
                    }
                }
            }

            // quan els dos es disparen
            function muertedos() {
                --pVidas;
                --cVidas;
                updateVidas();
                if (pVidas === 0 && cVidas === 0) {
                    // RESULTAT: EMPATEN PLAYER I COMPUTER
                    fin(2);
                }
                else if (pVidas === 0) {
                    // RESULTAT: GUANYA COMPUTER
                    fin(0);
                }
                else if (cVidas === 0) {
                    // RESULTAT: GUANYA PLAYER
                    fin(1);
                }
            }

            // actualitza valor de les vides dels jugadors
            function updateVidas() {
                document.getElementById("afegir_pvidas").textContent = "Vidas: "+ pVidas;
                document.getElementById("afegir_cvidas").textContent = "Vidas: "+ cVidas;
            }

            // quan algu perd definitivament la partida (vidas = 0)
            function fin(g) {
                // 0: guanya computer, 1: guanya player, 2: empaten
                btnStart = document.getElementById('start-win');
                if (g === 1 || g === 2) {
                    var overlay = document.getElementById('winOverlay'),
                    popup = document.getElementById('winPopup');
                    btnStart = document.getElementById('start-win');
                }
                else if (g === 0) {
                    var overlay = document.getElementById('loseOverlay'),
                    popup = document.getElementById('losePopup');
                    btnStart = document.getElementById('start-lose');
                }
                btnCerrarPopup = document.getElementById('btn-cerrar-popup'),
                overlay.classList.add('active');
                popup.classList.add('active');

                btnStart.addEventListener('click', function(e){
                    e.preventDefault();
                    overlay.classList.remove('active');
                    popup.classList.remove('active');
                    start();
                });
            }

            function start() {
                pRecarga = 0;
                cRecarga = 0;
                updateValors();
                pVidas = 1;
                cVidas = 1;
                updateVidas();
                document.getElementById("botresponse").src = "https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Question_mark_%28black%29.svg/480px-Question_mark_%28black%29.svg.png"
                numRondes = 0;
            }
            
                     
        </script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
	<script src="popup.js"></script>
</body>
</html>